<!doctype html>
<html>
    <head>
        <title>Projekt Titel</title>
        <script src="https://kit.fontawesome.com/8be3a50bcc.js" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
        <script src="./qrCodeScannerScript.js"></script>
        <link rel="stylesheet" href="css/style.css"></link>
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Sora:wght@200&display=swap" rel="stylesheet">
        <meta charset="utf-8" />
    </head>
    <body>
        <div class="left_to_right">
            <div class="sidebar_container">
                <div id="gen" class="round_btn active" onclick=""><i class="icon-qrcode"></i></div>
                <div id="scan" class="round_btn"><i class="icon-qrcode_scan"></i></div>
            </div>
            <div class="qrGen">
                <div class="container">
                    <div id="whatsinside">
                        <h1>Erstelle ein QR Code für dein Produkt</h1>
                        <img src="./knowwhatsinside.png" alt=""></img>
                        <p>Du willst deinen potentiellen Kunden die Möglichkeit geben genau nachzuschauen was in deinem Produkt drin ist und dieses auch in Zukunft weiter bearbeiten können? Toll denn genau darum geht es hier. Wir haben uns als Aufgabe gesetzt den Kunden volle Transparenz über Produkte zu verschaffen.</p>
                    </div>
                    <form id="qrForm" action="/add" method="POST">
                        <ul>
                            <div class="genForm">
                                <li>
                                    <input type="text" id = "name" name="name" placeholder="Produktname" required>
                                </li>
                                <li>
                                    <textarea rows="6" id = "desc" name="desc" placeholder="Beschreibung" required></textarea>
                                </li>
                                <li>
                                    <a onclick="document.getElementById('img').click();">Klicke hier um ein Bild hochzuladen</a>
                                    <input hidden="" type="file" accept="image/*" id = "img" name="img" placeholder="Füge ein Bild hinzu..." required></input>
                                </li>
                                <li>
                                    <select id = "type" name="type" placeholder="Wähle eine Kategorie" required>
                                        <option value="foodandbeverages">Food & Beverages</option>
                                        <option value="customandtourism">Custom & Tourism</option>
                                        <option value="digital">Digital</option>
                                    </select>
                                </li>
                                <li>
                                    <button type="submit" class="submit-qr">Generiere</i></button>
                                </li>
                            </div>
                        </ul>
                    </form>
                </div>
            </div>
            <image id="qrcode"></image>
            <div id="qrScanner" hidden="">
                <div class="container">
                    <div id="whatsinside">
                        <h1>Alle wichtigen Infos auf einen Blick</h1>
                        <img src="./knowwhatsinside.png" alt=""></img>
                        <p>Hast du dich schonmal gefragt, was sich in deiner neusten Anschaffung befindet? Wo es her kommt? Wir auch! Daher haben wir eine transparente Methode für dich herauszufinden was genau sich hinter deinem neusten Produkt befindet.</p>
                    </div>
                    <div class="scanimg">
                        <img src="./qrcode_scan.png" style="z-index: 999; position:absolute;" hidden="" id="overlay"></img> 
                        <canvas style="width:400px; height:400px; object-fit: cover; top:50%" hidden="" id="qr-canvas"></canvas>
                        <script src="./qrCodeScanner.js"></script>
                    </div>
                    <div class="dbinfo" hidden="">
                        <div>
                            <h1 id="toplist">Bild</h1>
                            <p id="dbimg" class="botlist"></p>
                        </div>
                        <div>
                            <h1 id="toplist">Produktname</h1>
                            <p id="dbname" class="botlist"></p>
                        </div>
                        <div>
                            <h1 id="toplist">Beschreibung</h1>
                            <p id="dbdesc" class="botlist"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
    <script>
        $(".round_btn").click(function() {
            if(!$(this).hasClass("active")) {
                $(".round_btn").toggleClass("active");
                $(this).addClass("active");
            }

            if($("#scan").hasClass("active")) {
                $(".qrGen").hide();
                $("#qrcode").hide();
                $("#qrScanner").show();
                //next step show scanner
            }

            if($("#gen").hasClass("active")) {
                $("#qrScanner").hide();
                $(".qrGen").show();
                $("#qrcode").show();
            }
        });

        $('#qrForm').submit(function(e){
            e.preventDefault();
            $.ajax({
                url: '/add',
                type: 'post',
                data:$('#qrForm').serialize(),
                success: function(){
                    console.log("Stopped Redirection ✅")
                }
            });
            document.getElementById("name").value = "";
            document.getElementById("desc").value = "";
            createQR();
        });
    </script>
</html>